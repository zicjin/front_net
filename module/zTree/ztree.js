define(function(){return function(J){(function(k){var E,A,q,f,l,u,m={},s={},v={},G=0,b={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0},data:{key:{children:"children",name:"name",title:""},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",
url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null}},a=[function(n){var i=n.treeObj,a=r.event;i.unbind(a.NODECREATED);i.bind(a.NODECREATED,function(i,a,b){t.apply(n.callback.onNodeCreated,[i,a,b])});i.unbind(a.CLICK);
i.bind(a.CLICK,function(i,a,b,c){t.apply(n.callback.onClick,[i,a,b,c])});i.unbind(a.EXPAND);i.bind(a.EXPAND,function(i,a,b){t.apply(n.callback.onExpand,[i,a,b])});i.unbind(a.COLLAPSE);i.bind(a.COLLAPSE,function(i,a,b){t.apply(n.callback.onCollapse,[i,a,b])});i.unbind(a.ASYNC_SUCCESS);i.bind(a.ASYNC_SUCCESS,function(i,a,b,c){t.apply(n.callback.onAsyncSuccess,[i,a,b,c])});i.unbind(a.ASYNC_ERROR);i.bind(a.ASYNC_ERROR,function(i,a,b,c,Q,d){t.apply(n.callback.onAsyncError,[i,a,b,c,Q,d])})}],c=[function(n){var i=
h.getCache(n);i||(i={},h.setCache(n,i));i.nodes=[];i.doms=[]}],d=[function(n,i,a,b,c,d){if(a){var e=n.data.key.children;a.level=i;a.tId=n.treeId+"_"+ ++G;a.parentTId=b?b.tId:null;a[e]&&0<a[e].length?("string"==typeof a.open&&(a.open=t.eqs(a.open,"true")),a.open=!!a.open,a.isParent=!0,a.zAsync=!0):(a.open=!1,"string"==typeof a.isParent&&(a.isParent=t.eqs(a.isParent,"true")),a.isParent=!!a.isParent,a.zAsync=!a.isParent);a.isFirstNode=c;a.isLastNode=d;a.getParentNode=function(){return h.getNodeCache(n,
a.parentTId)};a.getPreNode=function(){return h.getPreNode(n,a)};a.getNextNode=function(){return h.getNextNode(n,a)};a.isAjaxing=!1;h.fixPIdKeyValue(n,a)}}],e=[function(n){var a=n.target,b=m[n.data.treeId],c="",d=null,e="",g="",k=null,o=null,j=null;if(t.eqs(n.type,"mousedown"))g="mousedown";else if(t.eqs(n.type,"mouseup"))g="mouseup";else if(t.eqs(n.type,"contextmenu"))g="contextmenu";else if(t.eqs(n.type,"click"))if(t.eqs(a.tagName,"button")&&a.blur(),t.eqs(a.tagName,"button")&&null!==a.getAttribute("treeNode"+
r.id.SWITCH))c=a.parentNode.id,e="switchNode";else{if(j=t.getMDom(b,a,[{tagName:"a",attrName:"treeNode"+r.id.A}]))c=j.parentNode.id,e="clickNode"}else if(t.eqs(n.type,"dblclick")&&(g="dblclick",j=t.getMDom(b,a,[{tagName:"a",attrName:"treeNode"+r.id.A}])))c=j.parentNode.id,e="switchNode";if(0<g.length&&0==c.length&&(j=t.getMDom(b,a,[{tagName:"a",attrName:"treeNode"+r.id.A}])))c=j.parentNode.id;if(0<c.length)switch(d=h.getNodeCache(b,c),e){case "switchNode":d.isParent?t.eqs(n.type,"click")||t.eqs(n.type,
"dblclick")&&t.apply(b.view.dblClickExpand,[b.treeId,d],b.view.dblClickExpand)?k=E:e="":e="";break;case "clickNode":k=A}switch(g){case "mousedown":o=q;break;case "mouseup":o=f;break;case "dblclick":o=l;break;case "contextmenu":o=u}return{stop:!1,node:d,nodeEventType:e,nodeEventCallback:k,treeEventType:g,treeEventCallback:o}}],o=[function(n){var a=h.getRoot(n);a||(a={},h.setRoot(n,a));a.children=[];a.expandTriggerFlag=!1;a.curSelectedList=[];a.noSelection=!0;a.createdNodes=[]}],j=[],g=[],y=[],H=[],
I=[],h={addNodeCache:function(a,i){h.getCache(a).nodes[i.tId]=i},addAfterA:function(a){g.push(a)},addBeforeA:function(a){j.push(a)},addInnerAfterA:function(a){H.push(a)},addInnerBeforeA:function(a){y.push(a)},addInitBind:function(n){a.push(n)},addInitCache:function(a){c.push(a)},addInitNode:function(a){d.push(a)},addInitProxy:function(a){e.push(a)},addInitRoot:function(a){o.push(a)},addNodesData:function(a,i,b){var c=a.data.key.children;i[c]||(i[c]=[]);0<i[c].length&&(i[c][i[c].length-1].isLastNode=
!1,p.setNodeLineIcos(a,i[c][i[c].length-1]));i.isParent=!0;i[c]=i[c].concat(b)},addSelectedNode:function(a,i){var b=h.getRoot(a);h.isSelectedNode(a,i)||b.curSelectedList.push(i)},addCreatedNode:function(a,i){(a.callback.onNodeCreated||a.view.addDiyDom)&&h.getRoot(a).createdNodes.push(i)},addZTreeTools:function(a){I.push(a)},exSetting:function(a){k.extend(!0,b,a)},fixPIdKeyValue:function(a,i){a.data.simpleData.enable&&(i[a.data.simpleData.pIdKey]=i.parentTId?i.getParentNode()[a.data.simpleData.idKey]:
a.data.simpleData.rootPId)},getAfterA:function(a,i,b){for(var c=0,d=g.length;c<d;c++)g[c].apply(this,arguments)},getBeforeA:function(a,i,b){for(var c=0,d=j.length;c<d;c++)j[c].apply(this,arguments)},getInnerAfterA:function(a,i,b){for(var c=0,d=H.length;c<d;c++)H[c].apply(this,arguments)},getInnerBeforeA:function(a,i,b){for(var c=0,d=y.length;c<d;c++)y[c].apply(this,arguments)},getCache:function(a){return v[a.treeId]},getNextNode:function(a,i){if(!i)return null;var b=a.data.key.children,c=i.parentTId?
i.getParentNode():h.getRoot(a);if(!i.isLastNode){if(i.isFirstNode)return c[b][1];for(var d=1,e=c[b].length-1;d<e;d++)if(c[b][d]===i)return c[b][d+1]}return null},getNodeByParam:function(a,i,b,c){if(!i||!b)return null;for(var d=a.data.key.children,e=0,g=i.length;e<g;e++){if(i[e][b]==c)return i[e];var f=h.getNodeByParam(a,i[e][d],b,c);if(f)return f}return null},getNodeCache:function(a,i){if(!i)return null;var b=v[a.treeId].nodes[i];return b?b:null},getNodes:function(a){return h.getRoot(a)[a.data.key.children]},
getNodesByParam:function(a,i,b,c){if(!i||!b)return[];for(var d=a.data.key.children,e=[],g=0,f=i.length;g<f;g++)i[g][b]==c&&e.push(i[g]),e=e.concat(h.getNodesByParam(a,i[g][d],b,c));return e},getNodesByParamFuzzy:function(a,i,b,c){if(!i||!b)return[];for(var d=a.data.key.children,e=[],g=0,f=i.length;g<f;g++)"string"==typeof i[g][b]&&-1<i[g][b].indexOf(c)&&e.push(i[g]),e=e.concat(h.getNodesByParamFuzzy(a,i[g][d],b,c));return e},getPreNode:function(a,i){if(!i)return null;var b=a.data.key.children,c=i.parentTId?
i.getParentNode():h.getRoot(a);if(!i.isFirstNode){if(i.isLastNode)return c[b][c[b].length-2];for(var d=1,e=c[b].length-1;d<e;d++)if(c[b][d]===i)return c[b][d-1]}return null},getRoot:function(a){return a?s[a.treeId]:null},getSetting:function(a){return m[a]},getSettings:function(){return m},getTitleKey:function(a){return""===a.data.key.title?a.data.key.name:a.data.key.title},getZTreeTools:function(a){return(a=this.getRoot(this.getSetting(a)))?a.treeTools:null},initCache:function(a){for(var i=0,b=c.length;i<
b;i++)c[i].apply(this,arguments)},initNode:function(a,i,b,c,e,g){for(var h=0,f=d.length;h<f;h++)d[h].apply(this,arguments)},initRoot:function(a){for(var i=0,b=o.length;i<b;i++)o[i].apply(this,arguments)},isSelectedNode:function(a,i){for(var b=h.getRoot(a),c=0,d=b.curSelectedList.length;c<d;c++)if(i===b.curSelectedList[c])return!0;return!1},removeNodeCache:function(a,i){var b=a.data.key.children;if(i[b])for(var c=0,d=i[b].length;c<d;c++)arguments.callee(a,i[b][c]);delete h.getCache(a).nodes[i.tId]},
removeSelectedNode:function(a,i){for(var b=h.getRoot(a),c=0,d=b.curSelectedList.length;c<d;c++)if(i===b.curSelectedList[c]||!h.getNodeCache(a,b.curSelectedList[c].tId))b.curSelectedList.splice(c,1),c--,d--},setCache:function(a,i){v[a.treeId]=i},setRoot:function(a,i){s[a.treeId]=i},setZTreeTools:function(a,i){for(var b=0,c=I.length;b<c;b++)I[b].apply(this,arguments)},transformToArrayFormat:function(a,i){if(!i)return[];var b=a.data.key.children,c=[];if(t.isArray(i))for(var d=0,e=i.length;d<e;d++)c.push(i[d]),
i[d][b]&&(c=c.concat(h.transformToArrayFormat(a,i[d][b])));else c.push(i),i[b]&&(c=c.concat(h.transformToArrayFormat(a,i[b])));return c},transformTozTreeFormat:function(a,i){var b,c,d=a.data.simpleData.idKey,e=a.data.simpleData.pIdKey,g=a.data.key.children;if(!d||""==d||!i)return[];if(t.isArray(i)){var h=[],f=[];for(b=0,c=i.length;b<c;b++)f[i[b][d]]=i[b];for(b=0,c=i.length;b<c;b++)f[i[b][e]]&&i[b][d]!=i[b][e]?(f[i[b][e]][g]||(f[i[b][e]][g]=[]),f[i[b][e]][g].push(i[b])):h.push(i[b]);return h}return[i]}},
C={bindEvent:function(b){for(var i=0,c=a.length;i<c;i++)a[i].apply(this,arguments)},bindTree:function(a){var b={treeId:a.treeId},a=a.treeObj;a.unbind("click",C.proxy);a.bind("click",b,C.proxy);a.unbind("dblclick",C.proxy);a.bind("dblclick",b,C.proxy);a.unbind("mouseover",C.proxy);a.bind("mouseover",b,C.proxy);a.unbind("mouseout",C.proxy);a.bind("mouseout",b,C.proxy);a.unbind("mousedown",C.proxy);a.bind("mousedown",b,C.proxy);a.unbind("mouseup",C.proxy);a.bind("mouseup",b,C.proxy);a.unbind("contextmenu",
C.proxy);a.bind("contextmenu",b,C.proxy)},doProxy:function(a){for(var b=[],c=0,d=e.length;c<d;c++){var g=e[c].apply(this,arguments);b.push(g);if(g.stop)break}return b},proxy:function(a){var b=h.getSetting(a.data.treeId);if(!t.uCanDo(b,a))return!0;for(var c=C.doProxy(a),d=!0,e=!1,g=0,f=c.length;g<f;g++){var o=c[g];o.nodeEventCallback&&(e=!0,d=o.nodeEventCallback.apply(o,[a,o.node])&&d);o.treeEventCallback&&(e=!0,d=o.treeEventCallback.apply(o,[a,o.node])&&d)}try{e&&0==k("input:focus").length&&t.noSel(b)}catch(j){}return d}};
E=function(a,b){var c=m[a.data.treeId];if(b.open){if(!1==t.apply(c.callback.beforeCollapse,[c.treeId,b],!0))return!0}else if(!1==t.apply(c.callback.beforeExpand,[c.treeId,b],!0))return!0;h.getRoot(c).expandTriggerFlag=!0;p.switchNode(c,b);return!0};A=function(a,b){var c=m[a.data.treeId],d=c.view.autoCancelSelected&&a.ctrlKey&&h.isSelectedNode(c,b)?0:c.view.autoCancelSelected&&a.ctrlKey&&c.view.selectedMulti?2:1;if(!1==t.apply(c.callback.beforeClick,[c.treeId,b,d],!0))return!0;0===d?p.cancelPreSelectedNode(c,
b):p.selectNode(c,b,2===d);c.treeObj.trigger(r.event.CLICK,[c.treeId,b,d]);return!0};q=function(a,b){var c=m[a.data.treeId];t.apply(c.callback.beforeMouseDown,[c.treeId,b],!0)&&t.apply(c.callback.onMouseDown,[a,c.treeId,b]);return!0};f=function(a,b){var c=m[a.data.treeId];t.apply(c.callback.beforeMouseUp,[c.treeId,b],!0)&&t.apply(c.callback.onMouseUp,[a,c.treeId,b]);return!0};l=function(a,b){var c=m[a.data.treeId];t.apply(c.callback.beforeDblClick,[c.treeId,b],!0)&&t.apply(c.callback.onDblClick,[a,
c.treeId,b]);return!0};u=function(a,b){var c=m[a.data.treeId];t.apply(c.callback.beforeRightClick,[c.treeId,b],!0)&&t.apply(c.callback.onRightClick,[a,c.treeId,b]);return"function"!=typeof c.callback.onRightClick};var t={apply:function(a,b,c){return"function"==typeof a?a.apply(x,b?b:[]):c},canAsync:function(a,b){var c=a.data.key.children;return b&&b.isParent&&!(b.zAsync||b[c]&&0<b[c].length)},clone:function(a){var b;if(a instanceof Array){b=[];for(var c=a.length;c--;)b[c]=arguments.callee(a[c]);return b}if("function"==
typeof a)return a;if(a instanceof Object){b={};for(c in a)b[c]=arguments.callee(a[c]);return b}return a},eqs:function(a,b){return a.toLowerCase()===b.toLowerCase()},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},getMDom:function(a,b,c){if(!b)return null;for(;b&&b.id!==a.treeId;){for(var d=0,e=c.length;b.tagName&&d<e;d++)if(t.eqs(b.tagName,c[d].tagName)&&null!==b.getAttribute(c[d].attrName))return b;b=b.parentNode}return null},noSel:function(a){if(h.getRoot(a).noSelection)try{window.getSelection?
window.getSelection().removeAllRanges():document.selection.empty()}catch(b){}},uCanDo:function(){return!0}},p={addNodes:function(a,b,c,d){if(!a.data.keep.leaf||!b||b.isParent)if(t.isArray(c)||(c=[c]),a.data.simpleData.enable&&(c=h.transformTozTreeFormat(a,c)),b){var e=k("#"+b.tId+r.id.SWITCH),g=k("#"+b.tId+r.id.ICON),f=k("#"+b.tId+r.id.UL);b.open||(p.replaceSwitchClass(b,e,r.folder.CLOSE),p.replaceIcoClass(b,g,r.folder.CLOSE),b.open=!1,f.css({display:"none"}));h.addNodesData(a,b,c);p.createNodes(a,
b.level+1,c,b);d||p.expandCollapseParentNode(a,b,!0)}else h.addNodesData(a,h.getRoot(a),c),p.createNodes(a,0,c,null)},appendNodes:function(a,b,c,d,e,g){if(!c)return[];for(var f=[],o=a.data.key.children,k=a.data.key.name,j=h.getTitleKey(a),l=0,y=c.length;l<y;l++){var w=c[l],L=(d?d:h.getRoot(a))[o].length==c.length&&0==l,q=l==c.length-1;e&&(h.initNode(a,b,w,d,L,q,g),h.addNodeCache(a,w));L=[];w[o]&&0<w[o].length&&(L=p.appendNodes(a,b+1,w[o],w,e,g&&w.open));if(g){var q=p.makeNodeUrl(a,w),u=p.makeNodeFontCss(a,
w),s=[],m;for(m in u)s.push(m,":",u[m],";");f.push("<li id='",w.tId,"' class='level",w.level,"' treenode>","<button type='button' hidefocus='true'",w.isParent?"":"disabled"," id='",w.tId,r.id.SWITCH,"' title='' class='",p.makeNodeLineClass(a,w),"' treeNode",r.id.SWITCH,"></button>");h.getBeforeA(a,w,f);f.push("<a id='",w.tId,r.id.A,"' class='level",w.level,"' treeNode",r.id.A,' onclick="',w.click||"",'" ',null!=q&&0<q.length?"href='"+q+"'":""," target='",p.makeNodeTarget(w),"' style='",s.join(""),
"'");t.apply(a.view.showTitle,[a.treeId,w],a.view.showTitle)&&w[j]&&f.push("title='",w[j].replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'");f.push(">");h.getInnerBeforeA(a,w,f);q=a.view.nameIsHTML?w[k]:w[k].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");f.push("<button type='button' hidefocus='true' id='",w.tId,r.id.ICON,"' title='' treeNode",r.id.ICON," class='",p.makeNodeIcoClass(a,w),"' style='",p.makeNodeIcoStyle(a,w),"'></button><span id='",w.tId,r.id.SPAN,
"'>",q,"</span>");h.getInnerAfterA(a,w,f);f.push("</a>");h.getAfterA(a,w,f);w.isParent&&w.open&&p.makeUlHtml(a,w,f,L.join(""));f.push("</li>");h.addCreatedNode(a,w)}}return f},appendParentULDom:function(a,b){var c=[],d=k("#"+b.tId),e=k("#"+b.tId+r.id.UL),g=p.appendNodes(a,b.level+1,b[a.data.key.children],b,!1,!0);p.makeUlHtml(a,b,c,g.join(""));!d.get(0)&&b.parentTId&&(p.appendParentULDom(a,b.getParentNode()),d=k("#"+b.tId));e.get(0)&&e.remove();d.append(c.join(""));p.createNodeCallback(a)},asyncNode:function(a,
b,c,d){var e,g;if(b&&!b.isParent)return t.apply(d),!1;if(b&&b.isAjaxing)return!1;if(!1==t.apply(a.callback.beforeAsync,[a.treeId,b],!0))return t.apply(d),!1;b&&(b.isAjaxing=!0,k("#"+b.tId+r.id.ICON).attr({style:"","class":"ico_loading"}));var f="application/json"==a.async.contentType,h=f?"{":"",o="";for(e=0,g=a.async.autoParam.length;b&&e<g;e++){var j=a.async.autoParam[e].split("="),l=j;1<j.length&&(l=j[1],j=j[0]);f?(o="string"==typeof b[j]?'"':"",h+='"'+l+('":'+o+b[j]).replace(/'/g,"\\'")+o+","):
h+=l+("="+b[j]).replace(/&/g,"%26")+"&"}if(t.isArray(a.async.otherParam))for(e=0,g=a.async.otherParam.length;e<g;e+=2)f?(o="string"==typeof a.async.otherParam[e+1]?'"':"",h+='"'+a.async.otherParam[e]+('":'+o+a.async.otherParam[e+1]).replace(/'/g,"\\'")+o+","):h+=a.async.otherParam[e]+("="+a.async.otherParam[e+1]).replace(/&/g,"%26")+"&";else for(var y in a.async.otherParam)f?(o="string"==typeof a.async.otherParam[y]?'"':"",h+='"'+y+('":'+o+a.async.otherParam[y]).replace(/'/g,"\\'")+o+","):h+=y+("="+
a.async.otherParam[y]).replace(/&/g,"%26")+"&";1<h.length&&(h=h.substring(0,h.length-1));f&&(h+="}");k.ajax({contentType:a.async.contentType,type:a.async.type,url:t.apply(a.async.url,[a.treeId,b],a.async.url),data:h,dataType:a.async.dataType,success:function(e){var g=[];try{g=!e||0==e.length?[]:"string"==typeof e?eval("("+e+")"):e}catch(f){}b&&(b.isAjaxing=null,b.zAsync=!0);p.setNodeLineIcos(a,b);g&&""!=g?(g=t.apply(a.async.dataFilter,[a.treeId,b,g],g),p.addNodes(a,b,t.clone(g),!!c)):p.addNodes(a,
b,[],!!c);a.treeObj.trigger(r.event.ASYNC_SUCCESS,[a.treeId,b,e]);t.apply(d)},error:function(c,d,e){p.setNodeLineIcos(a,b);b&&(b.isAjaxing=null);a.treeObj.trigger(r.event.ASYNC_ERROR,[a.treeId,b,c,d,e])}});return!0},cancelPreSelectedNode:function(a,b){for(var c=h.getRoot(a).curSelectedList,d=c.length-1;0<=d;d--)if(!b||b===c[d])if(k("#"+c[d].tId+r.id.A).removeClass(r.node.CURSELECTED),p.setNodeName(a,c[d]),b){h.removeSelectedNode(a,b);break}b||(h.getRoot(a).curSelectedList=[])},createNodeCallback:function(a){if(a.callback.onNodeCreated||
a.view.addDiyDom)for(var b=h.getRoot(a);0<b.createdNodes.length;){var c=b.createdNodes.shift();t.apply(a.view.addDiyDom,[a.treeId,c]);a.callback.onNodeCreated&&a.treeObj.trigger(r.event.NODECREATED,[a.treeId,c])}},createNodes:function(a,b,c,d){if(c&&0!=c.length){var e=h.getRoot(a),g=a.data.key.children,g=!d||d.open||!!k("#"+d[g][0].tId).get(0);e.createdNodes=[];b=p.appendNodes(a,b,c,d,!0,g);d?(d=k("#"+d.tId+r.id.UL),d.get(0)&&d.append(b.join(""))):a.treeObj.append(b.join(""));p.createNodeCallback(a)}},
expandCollapseNode:function(a,b,c,d,e){var g=h.getRoot(a),f=a.data.key.children;if(b){if(g.expandTriggerFlag){var o=e,e=function(){o&&o();b.open?a.treeObj.trigger(r.event.EXPAND,[a.treeId,b]):a.treeObj.trigger(r.event.COLLAPSE,[a.treeId,b])};g.expandTriggerFlag=!1}if(b.open==c)t.apply(e,[]);else{!b.open&&b.isParent&&(!k("#"+b.tId+r.id.UL).get(0)||b[f]&&0<b[f].length&&!k("#"+b[f][0].tId).get(0))&&p.appendParentULDom(a,b);var c=k("#"+b.tId+r.id.UL),g=k("#"+b.tId+r.id.SWITCH),j=k("#"+b.tId+r.id.ICON);
b.isParent?(b.open=!b.open,b.iconOpen&&b.iconClose&&j.attr("style",p.makeNodeIcoStyle(a,b)),b.open?(p.replaceSwitchClass(b,g,r.folder.OPEN),p.replaceIcoClass(b,j,r.folder.OPEN),!1==d||""==a.view.expandSpeed?(c.show(),t.apply(e,[])):b[f]&&0<b[f].length?c.slideDown(a.view.expandSpeed,e):(c.show(),t.apply(e,[]))):(p.replaceSwitchClass(b,g,r.folder.CLOSE),p.replaceIcoClass(b,j,r.folder.CLOSE),!1==d||""==a.view.expandSpeed?(c.hide(),t.apply(e,[])):c.slideUp(a.view.expandSpeed,e))):t.apply(e,[])}}else t.apply(e,
[])},expandCollapseParentNode:function(a,b,c,d,e){b&&(b.parentTId?(p.expandCollapseNode(a,b,c,d),b.parentTId&&p.expandCollapseParentNode(a,b.getParentNode(),c,d,e)):p.expandCollapseNode(a,b,c,d,e))},expandCollapseSonNode:function(a,b,c,d,e){var g=h.getRoot(a),f=a.data.key.children,g=b?b[f]:g[f],f=b?!1:d,o=h.getRoot(a).expandTriggerFlag;h.getRoot(a).expandTriggerFlag=!1;if(g)for(var j=0,k=g.length;j<k;j++)g[j]&&p.expandCollapseSonNode(a,g[j],c,f);h.getRoot(a).expandTriggerFlag=o;p.expandCollapseNode(a,
b,c,d,e)},makeNodeFontCss:function(a,b){var c=t.apply(a.view.fontCss,[a.treeId,b],a.view.fontCss);return c&&"function"!=typeof c?c:{}},makeNodeIcoClass:function(a,b){var c=["ico"];b.isAjaxing||(c[0]=(b.iconSkin?b.iconSkin+"_":"")+c[0],b.isParent?c.push(b.open?r.folder.OPEN:r.folder.CLOSE):c.push(r.folder.DOCU));return c.join("_")},makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var d=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b.icon;d&&c.push("background:url(",d,") 0 0 no-repeat;");
(!1==a.view.showIcon||!t.apply(a.view.showIcon,[a.treeId,b],!0))&&c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(a,b){var c=[];a.view.showLine?0==b.level&&b.isFirstNode&&b.isLastNode?c.push(r.line.ROOT):0==b.level&&b.isFirstNode?c.push(r.line.ROOTS):b.isLastNode?c.push(r.line.BOTTOM):c.push(r.line.CENTER):c.push(r.line.NOLINE);b.isParent?c.push(b.open?r.folder.OPEN:r.folder.CLOSE):c.push(r.folder.DOCU);return p.makeNodeLineClassEx(b)+c.join("_")},makeNodeLineClassEx:function(a){return"level"+
a.level+" switch "},makeNodeTarget:function(a){return a.target||"_blank"},makeNodeUrl:function(a,b){return b.url?b.url:null},makeUlHtml:function(a,b,c,d){c.push("<ul id='",b.tId,r.id.UL,"' class='level",b.level," ",p.makeUlLineClass(a,b),"' style='display:",b.open?"block":"none","'>");c.push(d);c.push("</ul>")},makeUlLineClass:function(a,b){return a.view.showLine&&!b.isLastNode?r.line.LINE:""},replaceIcoClass:function(a,b,c){if(b&&!a.isAjaxing&&(a=b.attr("class"),void 0!=a)){a=a.split("_");switch(c){case r.folder.OPEN:case r.folder.CLOSE:case r.folder.DOCU:a[a.length-
1]=c}b.attr("class",a.join("_"))}},replaceSwitchClass:function(a,b,c){if(b){var d=b.attr("class");if(void 0!=d){d=d.split("_");switch(c){case r.line.ROOT:case r.line.ROOTS:case r.line.CENTER:case r.line.BOTTOM:case r.line.NOLINE:d[0]=p.makeNodeLineClassEx(a)+c;break;case r.folder.OPEN:case r.folder.CLOSE:case r.folder.DOCU:d[1]=c}b.attr("class",d.join("_"));c!==r.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},selectNode:function(a,b,c){c||p.cancelPreSelectedNode(a);k("#"+b.tId+
r.id.A).addClass(r.node.CURSELECTED);h.addSelectedNode(a,b)},setNodeFontCss:function(a,b){var c=k("#"+b.tId+r.id.A),d=p.makeNodeFontCss(a,b);d&&c.css(d)},setNodeLineIcos:function(a,b){if(b){var c=k("#"+b.tId+r.id.SWITCH),d=k("#"+b.tId+r.id.UL),e=k("#"+b.tId+r.id.ICON),g=p.makeUlLineClass(a,b);0==g.length?d.removeClass(r.line.LINE):d.addClass(g);c.attr("class",p.makeNodeLineClass(a,b));b.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled");e.removeAttr("style");e.attr("style",p.makeNodeIcoStyle(a,
b));e.attr("class",p.makeNodeIcoClass(a,b))}},setNodeName:function(a,b){var c=a.data.key.name,d=h.getTitleKey(a),e=k("#"+b.tId+r.id.SPAN);e.empty();a.view.nameIsHTML?e.html(b[c]):e.text(b[c]);t.apply(a.view.showTitle,[a.treeId,b],a.view.showTitle)&&b[d]&&k("#"+b.tId+r.id.A).attr("title",b[d])},setNodeTarget:function(a){k("#"+a.tId+r.id.A).attr("target",p.makeNodeTarget(a))},setNodeUrl:function(a,b){var c=k("#"+b.tId+r.id.A),d=p.makeNodeUrl(a,b);null==d||0==d.length?c.removeAttr("href"):c.attr("href",
d)},switchNode:function(a,b){b.open||!t.canAsync(a,b)?p.expandCollapseNode(a,b,!b.open):a.async.enable?p.asyncNode(a,b)||p.expandCollapseNode(a,b,!b.open):b&&p.expandCollapseNode(a,b,!b.open)}};k.fn.zTree={consts:{event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",
BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:t,view:p,event:C,data:h},getZTreeObj:function(a){return(a=h.getZTreeTools(a))?a:null},init:function(a,c,d){var e=t.clone(b);k.extend(!0,e,c);e.treeId=a.attr("id");e.treeObj=a;e.treeObj.empty();m[e.treeId]=e;k.browser.msie&&7>parseInt(k.browser.version)&&(e.view.expandSpeed="");h.initRoot(e);a=h.getRoot(e);c=e.data.key.children;d=d?t.clone(t.isArray(d)?d:[d]):
[];a[c]=e.data.simpleData.enable?h.transformTozTreeFormat(e,d):d;h.initCache(e);C.bindTree(e);C.bindEvent(e);d={setting:e,cancelSelectedNode:function(a){p.cancelPreSelectedNode(this.setting,a)},expandAll:function(a){a=!!a;p.expandCollapseSonNode(this.setting,null,a,!0);return a},expandNode:function(a,b,c,d,g){if(!a||!a.isParent)return null;!0!==b&&!1!==b&&(b=!a.open);if((g=!!g)&&b&&!1==t.apply(e.callback.beforeExpand,[e.treeId,a],!0)||g&&!b&&!1==t.apply(e.callback.beforeCollapse,[e.treeId,a],!0))return null;
b&&a.parentTId&&p.expandCollapseParentNode(this.setting,a.getParentNode(),b,!1);if(b===a.open&&!c)return null;h.getRoot(e).expandTriggerFlag=g;c?p.expandCollapseSonNode(this.setting,a,b,!0,function(){!1!==d&&k("#"+a.tId+r.id.ICON).focus().blur()}):(a.open=!b,p.switchNode(this.setting,a),!1!==d&&k("#"+a.tId+r.id.ICON).focus().blur());return b},getNodes:function(){return h.getNodes(this.setting)},getNodeByParam:function(a,b,c){return!a?null:h.getNodeByParam(this.setting,c?c[this.setting.data.key.children]:
h.getNodes(this.setting),a,b)},getNodeByTId:function(a){return h.getNodeCache(this.setting,a)},getNodesByParam:function(a,b,c){return!a?null:h.getNodesByParam(this.setting,c?c[this.setting.data.key.children]:h.getNodes(this.setting),a,b)},getNodesByParamFuzzy:function(a,b,c){return!a?null:h.getNodesByParamFuzzy(this.setting,c?c[this.setting.data.key.children]:h.getNodes(this.setting),a,b)},getNodeIndex:function(a){if(!a)return null;for(var b=e.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(this.setting),
d=0,g=c[b].length;d<g;d++)if(c[b][d]==a)return d;return-1},getSelectedNodes:function(){for(var a=[],b=h.getRoot(this.setting).curSelectedList,c=0,d=b.length;c<d;c++)a.push(b[c]);return a},isSelectedNode:function(a){return h.isSelectedNode(this.setting,a)},reAsyncChildNodes:function(a,b,c){if(this.setting.async.enable){var d=!a;d&&(a=h.getRoot(this.setting));"refresh"==b&&(a[this.setting.data.key.children]=[],d?this.setting.treeObj.empty():k("#"+a.tId+r.id.UL).empty());p.asyncNode(this.setting,d?null:
a,!!c)}},refresh:function(){this.setting.treeObj.empty();var a=h.getRoot(this.setting),b=a[this.setting.data.key.children];h.initRoot(this.setting);a[this.setting.data.key.children]=b;h.initCache(this.setting);p.createNodes(this.setting,0,a[this.setting.data.key.children])},selectNode:function(a,b){a&&t.uCanDo(this.setting)&&(b=e.view.selectedMulti&&b,a.parentTId?p.expandCollapseParentNode(this.setting,a.getParentNode(),!0,!1,function(){k("#"+a.tId+r.id.ICON).focus().blur()}):k("#"+a.tId+r.id.ICON).focus().blur(),
p.selectNode(this.setting,a,b))},transformTozTreeNodes:function(a){return h.transformTozTreeFormat(this.setting,a)},transformToArray:function(a){return h.transformToArrayFormat(this.setting,a)},updateNode:function(a){a&&k("#"+a.tId).get(0)&&t.uCanDo(this.setting)&&(p.setNodeName(this.setting,a),p.setNodeTarget(a),p.setNodeUrl(this.setting,a),p.setNodeLineIcos(this.setting,a),p.setNodeFontCss(this.setting,a))}};a.treeTools=d;h.setZTreeTools(e,d);a[c]&&0<a[c].length?p.createNodes(e,0,a[c]):e.async.enable&&
e.async.url&&""!==e.async.url&&p.asyncNode(e);return d}};var x=k.fn.zTree,r=x.consts})(J);(function(k){var E,A,q,f={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},l={check:{enable:!1,autoCheckTrigger:!1,chkStyle:f.checkbox.STYLE,nocheckInherit:!1,radioType:f.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},
callback:{beforeCheck:null,onCheck:null}};E=function(b,a){if(!0===a.chkDisabled)return!1;var c=v.getSetting(b.data.treeId),d=c.data.key.checked;if(!1==u.apply(c.callback.beforeCheck,[c.treeId,a],!0))return!0;a[d]=!a[d];s.checkNodeRelation(c,a);d=k("#"+a.tId+m.id.CHECK);s.setChkClass(c,d,a);s.repairParentChkClassWithSelf(c,a);c.treeObj.trigger(m.event.CHECK,[c.treeId,a]);return!0};A=function(b,a){if(!0===a.chkDisabled)return!1;var c=v.getSetting(b.data.treeId),d=k("#"+a.tId+m.id.CHECK);a.check_Focus=
!0;s.setChkClass(c,d,a);return!0};q=function(b,a){if(!0===a.chkDisabled)return!1;var c=v.getSetting(b.data.treeId),d=k("#"+a.tId+m.id.CHECK);a.check_Focus=!1;s.setChkClass(c,d,a);return!0};k.extend(!0,k.fn.zTree.consts,f);k.extend(!0,k.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(b,a){var c,d,e,f=b.data.key.children,j=b.data.key.checked;c=m.radio;if(b.check.chkStyle==c.STYLE){var g=v.getRadioCheckedList(b);if(a[j])if(b.check.radioType==c.TYPE_ALL){for(d=g.length-1;0<=d;d--)c=g[d],c[j]=!1,
g.splice(d,1),s.setChkClass(b,k("#"+c.tId+m.id.CHECK),c),c.parentTId!=a.parentTId&&s.repairParentChkClassWithSelf(b,c);g.push(a)}else{g=a.parentTId?a.getParentNode():v.getRoot(b);for(d=0,e=g[f].length;d<e;d++)c=g[f][d],c[j]&&c!=a&&(c[j]=!1,s.setChkClass(b,k("#"+c.tId+m.id.CHECK),c))}else if(b.check.radioType==c.TYPE_ALL)for(d=0,e=g.length;d<e;d++)if(a==g[d]){g.splice(d,1);break}}else a[j]&&(!a[f]||0==a[f].length||-1<b.check.chkboxType.Y.indexOf("s"))&&s.setSonNodeCheckBox(b,a,!0),!a[j]&&(!a[f]||0==
a[f].length||-1<b.check.chkboxType.N.indexOf("s"))&&s.setSonNodeCheckBox(b,a,!1),a[j]&&-1<b.check.chkboxType.Y.indexOf("p")&&s.setParentNodeCheckBox(b,a,!0),!a[j]&&-1<b.check.chkboxType.N.indexOf("p")&&s.setParentNodeCheckBox(b,a,!1)},makeChkClass:function(b,a){var c=b.data.key.checked,d=m.checkbox,e=m.radio,f="",f=!0===a.chkDisabled?d.DISABLED:a.halfCheck?d.PART:b.check.chkStyle==e.STYLE?1>a.check_Child_State?d.FULL:d.PART:a[c]?2===a.check_Child_State||-1===a.check_Child_State?d.FULL:d.PART:1>a.check_Child_State?
d.FULL:d.PART,c=b.check.chkStyle+"_"+(a[c]?d.TRUE:d.FALSE)+"_"+f,c=a.check_Focus&&!0!==a.chkDisabled?c+"_"+d.FOCUS:c;return d.DEFAULT+" "+c},repairAllChk:function(b,a){if(b.check.enable&&b.check.chkStyle===m.checkbox.STYLE)for(var c=b.data.key.checked,d=b.data.key.children,e=v.getRoot(b),f=0,j=e[d].length;f<j;f++){var g=e[d][f];!0!==g.nocheck&&(g[c]=a);s.setSonNodeCheckBox(b,g,a)}},repairChkClass:function(b,a){if(a){v.makeChkFlag(b,a);var c=k("#"+a.tId+m.id.CHECK);s.setChkClass(b,c,a)}},repairParentChkClass:function(b,
a){if(a&&a.parentTId){var c=a.getParentNode();s.repairChkClass(b,c);s.repairParentChkClass(b,c)}},repairParentChkClassWithSelf:function(b,a){if(a){var c=b.data.key.children;a[c]&&0<a[c].length?s.repairParentChkClass(b,a[c][0]):s.repairParentChkClass(b,a)}},repairSonChkDisabled:function(b,a,c){if(a){var d=b.data.key.children;a.chkDisabled!=c&&(a.chkDisabled=c,!0!==a.nocheck&&s.repairChkClass(b,a));if(a[d])for(var e=0,f=a[d].length;e<f;e++)s.repairSonChkDisabled(b,a[d][e],c)}},repairParentChkDisabled:function(b,
a,c){a&&(a.chkDisabled!=c&&(a.chkDisabled=c,!0!==a.nocheck&&s.repairChkClass(b,a)),s.repairParentChkDisabled(b,a.getParentNode(),c))},setChkClass:function(b,a,c){a&&(!0===c.nocheck?a.hide():a.show(),a.removeClass(),a.addClass(s.makeChkClass(b,c)))},setParentNodeCheckBox:function(b,a,c,d){var e=b.data.key.children,f=b.data.key.checked,j=k("#"+a.tId+m.id.CHECK);d||(d=a);v.makeChkFlag(b,a);!0!==a.nocheck&&!0!==a.chkDisabled&&(a[f]=c,s.setChkClass(b,j,a),b.check.autoCheckTrigger&&a!=d&&!0!==a.nocheck&&
b.treeObj.trigger(m.event.CHECK,[b.treeId,a]));if(a.parentTId){j=!0;if(!c)for(var e=a.getParentNode()[e],g=0,l=e.length;g<l;g++)if(!0!==e[g].nocheck&&e[g][f]||!0===e[g].nocheck&&0<e[g].check_Child_State){j=!1;break}j&&s.setParentNodeCheckBox(b,a.getParentNode(),c,d)}},setSonNodeCheckBox:function(b,a,c,d){if(a){var e=b.data.key.children,f=b.data.key.checked,j=k("#"+a.tId+m.id.CHECK);d||(d=a);var g=!1;if(a[e])for(var l=0,q=a[e].length;l<q&&!0!==a.chkDisabled;l++){var u=a[e][l];s.setSonNodeCheckBox(b,
u,c,d);!0===u.chkDisabled&&(g=!0)}a!=v.getRoot(b)&&!0!==a.chkDisabled&&(g&&!0!==a.nocheck&&v.makeChkFlag(b,a),!0!==a.nocheck?(a[f]=c,g||(a.check_Child_State=a[e]&&0<a[e].length?c?2:0:-1)):a.check_Child_State=-1,s.setChkClass(b,j,a),b.check.autoCheckTrigger&&a!=d&&!0!==a.nocheck&&b.treeObj.trigger(m.event.CHECK,[b.treeId,a]))}}},event:{},data:{getRadioCheckedList:function(b){for(var a=v.getRoot(b).radioCheckedList,c=0,d=a.length;c<d;c++)v.getNodeCache(b,a[c].tId)||(a.splice(c,1),c--,d--);return a},
getCheckStatus:function(b,a){if(!b.check.enable||a.nocheck)return null;var c=b.data.key.checked;return{checked:a[c],half:a.halfCheck?a.halfCheck:b.check.chkStyle==m.radio.STYLE?2===a.check_Child_State:a[c]?-1<a.check_Child_State&&2>a.check_Child_State:0<a.check_Child_State}},getTreeCheckedNodes:function(b,a,c,d){if(!a)return[];for(var e=b.data.key.children,f=b.data.key.checked,d=!d?[]:d,j=0,g=a.length;j<g;j++)!0!==a[j].nocheck&&a[j][f]==c&&d.push(a[j]),v.getTreeCheckedNodes(b,a[j][e],c,d);return d},
getTreeChangeCheckedNodes:function(b,a,c){if(!a)return[];for(var d=b.data.key.children,e=b.data.key.checked,c=!c?[]:c,f=0,j=a.length;f<j;f++)!0!==a[f].nocheck&&a[f][e]!=a[f].checkedOld&&c.push(a[f]),v.getTreeChangeCheckedNodes(b,a[f][d],c);return c},makeChkFlag:function(b,a){if(a){var c=b.data.key.children,d=b.data.key.checked,e=-1;if(a[c])for(var f=!1,j=0,g=a[c].length;j<g;j++){var k=a[c][j],l=-1;if(b.check.chkStyle==m.radio.STYLE)if(l=!0===k.nocheck?k.check_Child_State:!0===k.halfCheck?2:!0!==k.nocheck&&
k[d]?2:0<k.check_Child_State?2:0,2==l){e=2;break}else 0==l&&(e=0);else if(b.check.chkStyle==m.checkbox.STYLE){l=!0===k.nocheck?k.check_Child_State:!0===k.halfCheck?1:!0!==k.nocheck&&k[d]?-1===k.check_Child_State||2===k.check_Child_State?2:1:0<k.check_Child_State?1:0;if(1===l){e=1;break}else if(2===l&&f&&l!==e){e=1;break}else if(2===e&&-1<l&&2>l){e=1;break}else-1<l&&(e=l);f||(f=!0!==k.nocheck)}}a.check_Child_State=e}}}});var f=k.fn.zTree,u=f._z.tools,m=f.consts,s=f._z.view,v=f._z.data;v.exSetting(l);
v.addInitBind(function(b){var a=b.treeObj,c=m.event;a.unbind(c.CHECK);a.bind(c.CHECK,function(a,c,f){u.apply(b.callback.onCheck,[a,c,f])})});v.addInitCache(function(){});v.addInitNode(function(b,a,c,d,e,f){c&&(a=b.data.key.checked,"string"==typeof c[a]&&(c[a]=u.eqs(c[a],"true")),c[a]=!!c[a],c.checkedOld=c[a],c.nocheck=!!c.nocheck||b.check.nocheckInherit&&d&&!!d.nocheck,c.chkDisabled=!!c.chkDisabled||d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=u.eqs(c.halfCheck,"true")),c.halfCheck=
!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return v.getCheckStatus(b,c)},f&&v.makeChkFlag(b,d))});v.addInitProxy(function(b){var a=b.target,c=v.getSetting(b.data.treeId),d="",e=null,f="",k=null;u.eqs(b.type,"mouseover")?c.check.enable&&u.eqs(a.tagName,"button")&&null!==a.getAttribute("treeNode"+m.id.CHECK)&&(d=a.parentNode.id,f="mouseoverCheck"):u.eqs(b.type,"mouseout")?c.check.enable&&u.eqs(a.tagName,"button")&&null!==a.getAttribute("treeNode"+m.id.CHECK)&&
(d=a.parentNode.id,f="mouseoutCheck"):u.eqs(b.type,"click")&&c.check.enable&&u.eqs(a.tagName,"button")&&null!==a.getAttribute("treeNode"+m.id.CHECK)&&(d=a.parentNode.id,f="checkNode");if(0<d.length)switch(e=v.getNodeCache(c,d),f){case "checkNode":k=E;break;case "mouseoverCheck":k=A;break;case "mouseoutCheck":k=q}return{stop:!1,node:e,nodeEventType:f,nodeEventCallback:k,treeEventType:"",treeEventCallback:null}});v.addInitRoot(function(b){v.getRoot(b).radioCheckedList=[]});v.addBeforeA(function(b,a,
c){var d=b.data.key.checked;b.check.enable&&(v.makeChkFlag(b,a),b.check.chkStyle==m.radio.STYLE&&b.check.radioType==m.radio.TYPE_ALL&&a[d]&&v.getRoot(b).radioCheckedList.push(a),c.push("<button type='button' ID='",a.tId,m.id.CHECK,"' class='",s.makeChkClass(b,a),"' treeNode",m.id.CHECK," onfocus='this.blur();' ",!0===a.nocheck?"style='display:none;'":"","></button>"))});v.addZTreeTools(function(b,a){a.checkNode=function(a,c,f,j){var g=this.setting.data.key.checked;if(!0!==a.chkDisabled&&(!0!==c&&
!1!==c&&(c=!a[g]),j=!!j,(a[g]!==c||f)&&!(j&&!1==u.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0))&&u.uCanDo(this.setting)&&this.setting.check.enable&&!0!==a.nocheck))a[g]=c,c=k("#"+a.tId+m.id.CHECK),(f||this.setting.check.chkStyle===m.radio.STYLE)&&s.checkNodeRelation(this.setting,a),s.setChkClass(this.setting,c,a),s.repairParentChkClassWithSelf(this.setting,a),j&&b.treeObj.trigger(m.event.CHECK,[b.treeId,a])};a.checkAllNodes=function(a){s.repairAllChk(this.setting,!!a)};a.getCheckedNodes=
function(a){var c=this.setting.data.key.children;return v.getTreeCheckedNodes(this.setting,v.getRoot(b)[c],!1!==a)};a.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return v.getTreeChangeCheckedNodes(this.setting,v.getRoot(b)[a])};a.setChkDisabled=function(a,b){b=!!b;s.repairSonChkDisabled(this.setting,a,b);b||s.repairParentChkDisabled(this.setting,a,b)};var c=a.updateNode;a.updateNode=function(b,e){c&&c.apply(a,arguments);if(b&&this.setting.check.enable&&k("#"+b.tId).get(0)&&
u.uCanDo(this.setting)){var f=k("#"+b.tId+m.id.CHECK);(!0==e||this.setting.check.chkStyle===m.radio.STYLE)&&s.checkNodeRelation(this.setting,b);s.setChkClass(this.setting,f,b);s.repairParentChkClassWithSelf(this.setting,b)}}});var G=s.createNodes;s.createNodes=function(b,a,c,d){G&&G.apply(s,arguments);c&&s.repairParentChkClassWithSelf(b,d)}})(J);(function(k){var E={onHoverOverNode:function(b,a){var c=u.getSetting(b.data.treeId),d=u.getRoot(c);if(d.curHoverNode!=a)E.onHoverOutNode(b);d.curHoverNode=
a;l.addHoverDom(c,a)},onHoverOutNode:function(b){var b=u.getSetting(b.data.treeId),a=u.getRoot(b);a.curHoverNode&&!u.isSelectedNode(b,a.curHoverNode)&&(l.removeTreeDom(b,a.curHoverNode),a.curHoverNode=null)},onMousedownNode:function(b,a){function c(a){if(0==y.dragFlag&&Math.abs(J-a.clientX)<g.edit.drag.minMoveSize&&Math.abs(R-a.clientY)<g.edit.drag.minMoveSize)return!0;var b,c,e,j,o;o=g.data.key.children;q.noSel(g);k("body").css("cursor","pointer");if(0==y.dragFlag){if(!1==q.apply(g.callback.beforeDrag,
[g.treeId,h],!0))return d(a),!0;for(b=0,c=h.length;b<c;b++)0==b&&(y.dragNodeShowBefore=[]),e=h[b],e.isParent&&e.open?(l.expandCollapseNode(g,e,!e.open),y.dragNodeShowBefore[e.tId]=!0):y.dragNodeShowBefore[e.tId]=!1;y.dragFlag=1;y.showHoverDom=!1;q.showIfameMask(g,!0);e=!0;j=-1;if(1<h.length){var m=h[0].parentTId?h[0].getParentNode()[o]:u.getNodes(g);o=[];for(b=0,c=m.length;b<c;b++)if(void 0!==y.dragNodeShowBefore[m[b].tId]&&(e&&-1<j&&j+1!==b&&(e=!1),o.push(m[b]),j=b),h.length===o.length){h=o;break}}e&&
(i=h[0].getPreNode(),A=h[h.length-1].getNextNode());t=k("<ul class='zTreeDragUL'></ul>");for(b=0,c=h.length;b<c;b++)if(e=h[b],e.editNameFlag=!1,l.selectNode(g,e,0<b),l.removeTreeDom(g,e),j=k("<li id='"+e.tId+"_tmp'></li>"),j.append(k("#"+e.tId+f.id.A).clone()),j.css("padding","0"),j.children("#"+e.tId+f.id.A).removeClass(f.node.CURSELECTED),t.append(j),b==g.edit.drag.maxShowNodeNum-1){j=k("<li id='"+e.tId+"_moretmp'><a>  ...  </a></li>");t.append(j);break}t.attr("id",h[0].tId+f.id.UL+"_tmp");t.addClass(g.treeObj.attr("class"));
t.appendTo("body");p=k("<button class='tmpzTreeMove_arrow'></button>");p.attr("id","zTreeMove_arrow_tmp");p.appendTo("body");g.treeObj.trigger(f.event.DRAG,[g.treeId,h])}if(1==y.dragFlag&&p.attr("id")!=a.target.id){x&&(x.removeClass(f.node.TMPTARGET_TREE),B&&k("#"+B+f.id.A,x).removeClass(f.node.TMPTARGET_NODE));B=x=null;r=!1;n=g;e=u.getSettings();for(var s in e)if(e[s].treeId&&e[s].edit.enable&&e[s].treeId!=g.treeId&&(a.target.id==e[s].treeId||0<k(a.target).parents("#"+e[s].treeId).length))r=!0,n=
e[s];s=v.scrollTop();j=v.scrollLeft();o=n.treeObj.offset();b=n.treeObj.get(0).scrollHeight;e=n.treeObj.get(0).scrollWidth;c=a.clientY+s-o.top;var K=n.treeObj.height()+o.top-a.clientY-s,I=a.clientX+j-o.left,H=n.treeObj.width()+o.left-a.clientX-j;o=c<g.edit.drag.borderMax&&c>g.edit.drag.borderMin;var m=K<g.edit.drag.borderMax&&K>g.edit.drag.borderMin,O=I<g.edit.drag.borderMax&&I>g.edit.drag.borderMin,P=H<g.edit.drag.borderMax&&H>g.edit.drag.borderMin,K=c>g.edit.drag.borderMin&&K>g.edit.drag.borderMin&&
I>g.edit.drag.borderMin&&H>g.edit.drag.borderMin,I=o&&0>=n.treeObj.scrollTop(),H=m&&n.treeObj.scrollTop()+n.treeObj.height()+10>=b,S=O&&0>=n.treeObj.scrollLeft(),T=P&&n.treeObj.scrollLeft()+n.treeObj.width()+10>=e;if(a.target.id&&0<n.treeObj.find("#"+a.target.id).length){for(var F=a.target;F&&F.tagName&&!q.eqs(F.tagName,"li")&&F.id!=n.treeId;)F=F.parentNode;var M=!0;for(b=0,c=h.length;b<c;b++)if(e=h[b],F.id===e.tId){M=!1;break}else if(0<k("#"+e.tId).find("#"+F.id).length){M=!1;break}if(M&&a.target.id&&
(a.target.id==F.id+f.id.A||0<k(a.target).parents("#"+F.id+f.id.A).length))x=k(F),B=F.id}e=h[0];if(K&&(a.target.id==n.treeId||0<k(a.target).parents("#"+n.treeId).length)){if(!x&&(a.target.id==n.treeId||I||H||S||T)&&(r||!r&&e.parentTId))x=n.treeObj;o?n.treeObj.scrollTop(n.treeObj.scrollTop()-10):m&&n.treeObj.scrollTop(n.treeObj.scrollTop()+10);O?n.treeObj.scrollLeft(n.treeObj.scrollLeft()-10):P&&n.treeObj.scrollLeft(n.treeObj.scrollLeft()+10);x&&x!=n.treeObj&&x.offset().left<n.treeObj.offset().left&&
n.treeObj.scrollLeft(n.treeObj.scrollLeft()+x.offset().left-n.treeObj.offset().left)}t.css({top:a.clientY+s+3+"px",left:a.clientX+j+3+"px"});j=b=0;if(x&&x.attr("id")!=n.treeId){var D=null==B?null:u.getNodeCache(n,B);c=a.ctrlKey&&g.edit.drag.isMove&&g.edit.drag.isCopy||!g.edit.drag.isMove&&g.edit.drag.isCopy;b=!!(i&&B===i.tId);o=!!(A&&B===A.tId);j=e.parentTId&&e.parentTId==B;e=(c||!o)&&q.apply(n.edit.drag.prev,[n.treeId,h,D],!!n.edit.drag.prev);b=(c||!b)&&q.apply(n.edit.drag.next,[n.treeId,h,D],!!n.edit.drag.next);
o=(c||!j)&&!(n.data.keep.leaf&&!D.isParent)&&q.apply(n.edit.drag.inner,[n.treeId,h,D],!!n.edit.drag.inner);if(!e&&!b&&!o)x=null,B="",z=f.move.TYPE_INNER,p.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);else{c=k("#"+B+f.id.A,x);c.addClass(f.node.TMPTARGET_NODE);j=e?o?0.25:b?0.5:1:-1;o=b?o?0.75:e?0.5:0:-1;a=(a.clientY+s-c.offset().top)/c.height();(1==j||a<=j&&-0.2<=a)&&e?(b=1-p.width(),j=0-p.height()/2,z=f.move.TYPE_PREV):(0==o||
a>=o&&1.2>=a)&&b?(b=1-p.width(),j=c.height()-p.height()/2,z=f.move.TYPE_NEXT):(b=5-p.width(),j=0,z=f.move.TYPE_INNER);p.css({display:"block",top:c.offset().top+j+"px",left:c.offset().left+b+"px"});if(E!=B||G!=z)N=(new Date).getTime();D&&D.isParent&&z==f.move.TYPE_INNER&&(a=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==D.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===D.tId&&(a=!1),a&&(window.zTreeMoveTimer=
setTimeout(function(){z==f.move.TYPE_INNER&&D&&D.isParent&&!D.open&&(new Date).getTime()-N>n.edit.drag.autoOpenTime&&q.apply(n.callback.beforeDragOpen,[n.treeId,D],!0)&&(l.switchNode(n,D),n.edit.drag.autoExpandTrigger&&n.treeObj.trigger(f.event.EXPAND,[n.treeId,D]))},n.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=D.tId))}}else z=f.move.TYPE_INNER,x&&q.apply(n.edit.drag.inner,[n.treeId,h,null],!!n.edit.drag.inner)?x.addClass(f.node.TMPTARGET_TREE):x=null,p.css({display:"none"}),window.zTreeMoveTimer&&
(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);E=B;G=z}return!1}function d(a){window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);G=E=null;v.unbind("mousemove",c);v.unbind("mouseup",d);v.unbind("selectstart",e);k("body").css("cursor","auto");x&&(x.removeClass(f.node.TMPTARGET_TREE),B&&k("#"+B+f.id.A,x).removeClass(f.node.TMPTARGET_NODE));q.showIfameMask(g,!1);y.showHoverDom=!0;if(0!=y.dragFlag){y.dragFlag=0;var b,i,j;for(b=0,i=
h.length;b<i;b++)j=h[b],j.isParent&&y.dragNodeShowBefore[j.tId]&&!j.open&&(l.expandCollapseNode(g,j,!j.open),delete y.dragNodeShowBefore[j.tId]);t&&t.remove();p&&p.remove();var o=a.ctrlKey&&g.edit.drag.isMove&&g.edit.drag.isCopy||!g.edit.drag.isMove&&g.edit.drag.isCopy;!o&&x&&B&&h[0].parentTId&&B==h[0].parentTId&&z==f.move.TYPE_INNER&&(x=null);if(x){var s=null==B?null:u.getNodeCache(n,B);if(!1!=q.apply(g.callback.beforeDrop,[n.treeId,h,s,z],!0)){var m=o?q.clone(h):h,a=function(){if(r){if(!o)for(var a=
0,b=h.length;a<b;a++)l.removeNode(g,h[a]);if(z==f.move.TYPE_INNER)l.addNodes(n,s,m);else if(l.addNodes(n,s.getParentNode(),m),z==f.move.TYPE_PREV)for(a=0,b=m.length;a<b;a++)l.moveNode(n,s,m[a],z,!1);else for(a=-1,b=m.length-1;a<b;b--)l.moveNode(n,s,m[b],z,!1)}else if(o&&z==f.move.TYPE_INNER)l.addNodes(n,s,m);else if(o&&l.addNodes(n,s.getParentNode(),m),z==f.move.TYPE_PREV)for(a=0,b=m.length;a<b;a++)l.moveNode(n,s,m[a],z,!1);else for(a=-1,b=m.length-1;a<b;b--)l.moveNode(n,s,m[b],z,!1);for(a=0,b=m.length;a<
b;a++)l.selectNode(n,m[a],0<a);k("#"+m[0].tId+f.id.ICON).focus().blur()};z==f.move.TYPE_INNER&&q.canAsync(n,s)?l.asyncNode(n,s,!1,a):a();g.treeObj.trigger(f.event.DROP,[n.treeId,m,s,z])}}else{for(b=0,i=h.length;b<i;b++)l.selectNode(n,h[b],0<b);g.treeObj.trigger(f.event.DROP,[g.treeId,null,null,null])}}}function e(){return!1}var o,j,g=u.getSetting(b.data.treeId),y=u.getRoot(g);if(2==b.button||!g.edit.enable||!g.edit.drag.isCopy&&!g.edit.drag.isMove)return!0;var s=b.target,m=u.getRoot(g).curSelectedList,
h=[];if(u.isSelectedNode(g,a))for(o=0,j=m.length;o<j;o++){if(m[o].editNameFlag&&q.eqs(s.tagName,"input")&&null!==s.getAttribute("treeNode"+f.id.INPUT))return!0;h.push(m[o]);if(h[0].parentTId!==m[o].parentTId){h=[a];break}}else h=[a];l.editNodeBlur=!0;l.cancelCurEditNode(g,null,!0);var v=k(document),t,p,x,r=!1,n=g,i,A,E=null,G=null,B=null,z=f.move.TYPE_INNER,J=b.clientX,R=b.clientY,N=(new Date).getTime();q.uCanDo(g)&&v.bind("mousemove",c);v.bind("mouseup",d);v.bind("selectstart",e);b.preventDefault&&
b.preventDefault();return!0}},A={tools:{getAbs:function(b){b=b.getBoundingClientRect();return[b.left,b.top]},inputFocus:function(b){b.get(0)&&(b.focus(),q.setCursorPosition(b.get(0),b.val().length))},inputSelect:function(b){b.get(0)&&(b.focus(),b.select())},setCursorPosition:function(b,a){if(b.setSelectionRange)b.focus(),b.setSelectionRange(a,a);else if(b.createTextRange){var c=b.createTextRange();c.collapse(!0);c.moveEnd("character",a);c.moveStart("character",a);c.select()}},showIfameMask:function(b,
a){for(var c=u.getRoot(b);0<c.dragMaskList.length;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(a)for(var d=k("iframe"),e=0,f=d.length;e<f;e++){var j=d.get(e),g=q.getAbs(j),j=k("<div id='zTreeMask_"+e+"' class='zTreeMask' style='background-color:yellow;opacity: 0.3;filter: alpha(opacity=30);    top:"+g[1]+"px; left:"+g[0]+"px; width:"+j.offsetWidth+"px; height:"+j.offsetHeight+"px;'></div>");j.appendTo("body");c.dragMaskList.push(j)}}},view:{addEditBtn:function(b,a){if(!(a.editNameFlag||0<
k("#"+a.tId+f.id.EDIT).length)&&q.apply(b.edit.showRenameBtn,[b.treeId,a],b.edit.showRenameBtn)){var c=k("#"+a.tId+f.id.A),d="<button type='button' class='edit' id='"+a.tId+f.id.EDIT+"' title='"+q.apply(b.edit.renameTitle,[b.treeId,a],b.edit.renameTitle)+"' treeNode"+f.id.EDIT+" onfocus='this.blur();' style='display:none;'></button>";c.append(d);k("#"+a.tId+f.id.EDIT).bind("click",function(){if(!q.uCanDo(b)||!1==q.apply(b.callback.beforeEditName,[b.treeId,a],!0))return!0;l.editNode(b,a);return!1}).show()}},
addRemoveBtn:function(b,a){if(!(a.editNameFlag||0<k("#"+a.tId+f.id.REMOVE).length)&&q.apply(b.edit.showRemoveBtn,[b.treeId,a],b.edit.showRemoveBtn)){var c=k("#"+a.tId+f.id.A),d="<button type='button' class='remove' id='"+a.tId+f.id.REMOVE+"' title='"+q.apply(b.edit.removeTitle,[b.treeId,a],b.edit.removeTitle)+"' treeNode"+f.id.REMOVE+" onfocus='this.blur();' style='display:none;'></button>";c.append(d);k("#"+a.tId+f.id.REMOVE).bind("click",function(){if(!q.uCanDo(b)||!1==q.apply(b.callback.beforeRemove,
[b.treeId,a],!0))return!0;l.removeNode(b,a);b.treeObj.trigger(f.event.REMOVE,[b.treeId,a]);return!1}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(b,a){u.getRoot(b).showHoverDom&&(a.isHover=!0,b.edit.enable&&(l.addEditBtn(b,a),l.addRemoveBtn(b,a)),q.apply(b.view.addHoverDom,[b.treeId,a]))},cancelCurEditNode:function(b,a){var c=u.getRoot(b),d=b.data.key.name,e=c.curEditNode;if(e){var o=c.curEditInput,j=a?a:o.val();if(!a&&!1===q.apply(b.callback.beforeRename,[b.treeId,e,j],!0))return e.editNameFlag=
!0,!1;e[d]=j?j:o.val();a||b.treeObj.trigger(f.event.RENAME,[b.treeId,e]);k("#"+e.tId+f.id.A).removeClass(f.node.CURSELECTED_EDIT);o.unbind();l.setNodeName(b,e);e.editNameFlag=!1;c.curEditNode=null;c.curEditInput=null;l.selectNode(b,e,!1)}return c.noSelection=!0},editNode:function(b,a){var c=u.getRoot(b);l.editNodeBlur=!1;if(u.isSelectedNode(b,a)&&c.curEditNode==a&&a.editNameFlag)setTimeout(function(){q.inputFocus(c.curEditInput)},0);else{var d=b.data.key.name;a.editNameFlag=!0;l.removeTreeDom(b,a);
l.cancelCurEditNode(b);l.selectNode(b,a,!1);k("#"+a.tId+f.id.SPAN).html("<input type=text class='rename' id='"+a.tId+f.id.INPUT+"' treeNode"+f.id.INPUT+" >");var e=k("#"+a.tId+f.id.INPUT);e.attr("value",a[d]);b.edit.editNameSelectAll?q.inputSelect(e):q.inputFocus(e);e.bind("blur",function(){l.editNodeBlur||l.cancelCurEditNode(b)}).bind("keydown",function(c){"13"==c.keyCode?(l.editNodeBlur=!0,l.cancelCurEditNode(b,null,!0)):"27"==c.keyCode&&l.cancelCurEditNode(b,a[d])}).bind("click",function(){return!1}).bind("dblclick",
function(){return!1});k("#"+a.tId+f.id.A).addClass(f.node.CURSELECTED_EDIT);c.curEditInput=e;c.noSelection=!1;c.curEditNode=a}},moveNode:function(b,a,c,d,e,o){var j=u.getRoot(b),g=b.data.key.children;if(!(a==c||b.data.keep.leaf&&a&&!a.isParent&&d==f.move.TYPE_INNER)){var m=c.parentTId?c.getParentNode():j,s=null===a||a==j;s&&null===a&&(a=j);s&&(d=f.move.TYPE_INNER);j=a.parentTId?a.getParentNode():j;d!=f.move.TYPE_PREV&&d!=f.move.TYPE_NEXT&&(d=f.move.TYPE_INNER);var q,h;s?h=q=b.treeObj:o||(d==f.move.TYPE_INNER?
l.expandCollapseNode(b,a,!0,!1):l.expandCollapseNode(b,a.getParentNode(),!0,!1),q=k("#"+a.tId),h=k("#"+a.tId+f.id.UL));var v=k("#"+c.tId).remove();h&&d==f.move.TYPE_INNER?h.append(v):q&&d==f.move.TYPE_PREV?q.before(v):q&&d==f.move.TYPE_NEXT&&q.after(v);var t=-1,p=0,x=null;q=null;var r=c.level;if(c.isFirstNode)t=0,1<m[g].length&&(x=m[g][1],x.isFirstNode=!0);else if(c.isLastNode)t=m[g].length-1,x=m[g][t-1],x.isLastNode=!0;else for(h=0,v=m[g].length;h<v;h++)if(m[g][h].tId==c.tId){t=h;break}0<=t&&m[g].splice(t,
1);if(d!=f.move.TYPE_INNER)for(h=0,v=j[g].length;h<v;h++)j[g][h].tId==a.tId&&(p=h);d==f.move.TYPE_INNER?(s?c.parentTId=null:(a.isParent=!0,a.open=!1,c.parentTId=a.tId),a[g]||(a[g]=[]),0<a[g].length&&(q=a[g][a[g].length-1],q.isLastNode=!1),a[g].splice(a[g].length,0,c),c.isLastNode=!0,c.isFirstNode=1==a[g].length):a.isFirstNode&&d==f.move.TYPE_PREV?(j[g].splice(p,0,c),q=a,q.isFirstNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!0,c.isLastNode=!1):a.isLastNode&&d==f.move.TYPE_NEXT?(j[g].splice(p+1,0,
c),q=a,q.isLastNode=!1,c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(d==f.move.TYPE_PREV?j[g].splice(p,0,c):j[g].splice(p+1,0,c),c.parentTId=a.parentTId,c.isFirstNode=!1,c.isLastNode=!1);u.fixPIdKeyValue(b,c);u.setSonNodeLevel(b,c.getParentNode(),c);l.setNodeLineIcos(b,c);l.repairNodeLevelClass(b,c,r);!b.data.keep.parent&&1>m[g].length?(m.isParent=!1,m.open=!1,a=k("#"+m.tId+f.id.UL),d=k("#"+m.tId+f.id.SWITCH),g=k("#"+m.tId+f.id.ICON),l.replaceSwitchClass(m,d,f.folder.DOCU),l.replaceIcoClass(m,
g,f.folder.DOCU),a.css("display","none")):x&&l.setNodeLineIcos(b,x);q&&l.setNodeLineIcos(b,q);b.check.enable&&l.repairChkClass&&(l.repairChkClass(b,m),l.repairParentChkClassWithSelf(b,m),m!=c.parent&&l.repairParentChkClassWithSelf(b,c));o||l.expandCollapseParentNode(b,c.getParentNode(),!0,e)}},removeChildNodes:function(b,a){if(a){var c=b.data.key.children,d=a[c];if(d){k("#"+a.tId+f.id.UL).remove();for(var e=0,o=d.length;e<o;e++)u.removeNodeCache(b,d[e]);u.removeSelectedNode(b);delete a[c];b.data.keep.parent||
(a.isParent=!1,a.open=!1,c=k("#"+a.tId+f.id.SWITCH),d=k("#"+a.tId+f.id.ICON),l.replaceSwitchClass(a,c,f.folder.DOCU),l.replaceIcoClass(a,d,f.folder.DOCU))}}},removeEditBtn:function(b){k("#"+b.tId+f.id.EDIT).unbind().remove()},removeNode:function(b,a){var c=u.getRoot(b),d=b.data.key.children,e=a.parentTId?a.getParentNode():c;c.curEditNode===a&&(c.curEditNode=null);a.isFirstNode=!1;a.isLastNode=!1;a.getPreNode=function(){return null};a.getNextNode=function(){return null};k("#"+a.tId).remove();u.removeNodeCache(b,
a);u.removeSelectedNode(b,a);for(var o=0,j=e[d].length;o<j;o++)if(e[d][o].tId==a.tId){e[d].splice(o,1);break}var g;if(!b.data.keep.parent&&1>e[d].length)e.isParent=!1,e.open=!1,o=k("#"+e.tId+f.id.UL),j=k("#"+e.tId+f.id.SWITCH),g=k("#"+e.tId+f.id.ICON),l.replaceSwitchClass(e,j,f.folder.DOCU),l.replaceIcoClass(e,g,f.folder.DOCU),o.css("display","none");else if(b.view.showLine&&0<e[d].length){var m=e[d][e[d].length-1];m.isLastNode=!0;m.isFirstNode=1==e[d].length;o=k("#"+m.tId+f.id.UL);j=k("#"+m.tId+
f.id.SWITCH);g=k("#"+m.tId+f.id.ICON);e==c?1==e[d].length?l.replaceSwitchClass(m,j,f.line.ROOT):(c=k("#"+e[d][0].tId+f.id.SWITCH),l.replaceSwitchClass(e[d][0],c,f.line.ROOTS),l.replaceSwitchClass(m,j,f.line.BOTTOM)):l.replaceSwitchClass(m,j,f.line.BOTTOM);o.removeClass(f.line.LINE)}},removeRemoveBtn:function(b){k("#"+b.tId+f.id.REMOVE).unbind().remove()},removeTreeDom:function(b,a){a.isHover=!1;l.removeEditBtn(a);l.removeRemoveBtn(a);q.apply(b.view.removeHoverDom,[b.treeId,a])},repairNodeLevelClass:function(b,
a,c){if(c!==a.level){var b=k("#"+a.tId),d=k("#"+a.tId+f.id.A),e=k("#"+a.tId+f.id.UL),c="level"+c,a="level"+a.level;b.removeClass(c);b.addClass(a);d.removeClass(c);d.addClass(a);e.removeClass(c);e.addClass(a)}}},event:A,data:{setSonNodeLevel:function(b,a,c){if(c){var d=b.data.key.children;c.level=a?a.level+1:0;if(c[d])for(var a=0,e=c[d].length;a<e;a++)c[d][a]&&u.setSonNodeLevel(b,c,c[d][a])}}}};k.extend(!0,k.fn.zTree.consts,{event:{DRAG:"ztree_drag",DROP:"ztree_drop",REMOVE:"ztree_remove",RENAME:"ztree_rename"},
id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}});k.extend(!0,k.fn.zTree._z,A);var A=k.fn.zTree,q=A._z.tools,f=A.consts,l=A._z.view,u=A._z.data,A=A._z.event;u.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,
prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRemove:null,beforeRename:null,onDrag:null,onDrop:null,onRemove:null,onRename:null}});u.addInitBind(function(b){var a=b.treeObj,c=f.event;a.unbind(c.RENAME);a.bind(c.RENAME,function(a,c,f){q.apply(b.callback.onRename,[a,c,f])});a.unbind(c.REMOVE);a.bind(c.REMOVE,function(a,
c,f){q.apply(b.callback.onRemove,[a,c,f])});a.unbind(c.DRAG);a.bind(c.DRAG,function(a,c,f){q.apply(b.callback.onDrag,[a,c,f])});a.unbind(c.DROP);a.bind(c.DROP,function(a,c,f,j,g){q.apply(b.callback.onDrop,[a,c,f,j,g])})});u.addInitCache(function(){});u.addInitNode(function(b,a,c){c&&(c.isHover=!1,c.editNameFlag=!1)});u.addInitProxy(function(b){var a=b.target,c=u.getSetting(b.data.treeId),d=b.relatedTarget,e="",k=null,j="",g=null,l=null;if(q.eqs(b.type,"mouseover")){if(l=q.getMDom(c,a,[{tagName:"a",
attrName:"treeNode"+f.id.A}]))e=l.parentNode.id,j="hoverOverNode"}else if(q.eqs(b.type,"mouseout"))l=q.getMDom(c,d,[{tagName:"a",attrName:"treeNode"+f.id.A}]),l||(e="remove",j="hoverOutNode");else if(q.eqs(b.type,"mousedown")&&(l=q.getMDom(c,a,[{tagName:"a",attrName:"treeNode"+f.id.A}])))e=l.parentNode.id,j="mousedownNode";if(0<e.length)switch(k=u.getNodeCache(c,e),j){case "mousedownNode":g=E.onMousedownNode;break;case "hoverOverNode":g=E.onHoverOverNode;break;case "hoverOutNode":g=E.onHoverOutNode}return{stop:!1,
node:k,nodeEventType:j,nodeEventCallback:g,treeEventType:"",treeEventCallback:null}});u.addInitRoot(function(b){b=u.getRoot(b);b.curEditNode=null;b.curEditInput=null;b.curHoverNode=null;b.dragFlag=0;b.dragNodeShowBefore=[];b.dragMaskList=[];b.showHoverDom=!0});u.addZTreeTools(function(b,a){a.addNodes=function(a,d,e){function f(){l.addNodes(b,a,j,!0==e)}if(!d)return null;a||(a=null);if(a&&!a.isParent&&b.data.keep.leaf)return null;var j=q.clone(q.isArray(d)?d:[d]);b.async.enable&&q.canAsync(b,a)?l.asyncNode(b,
a,e,f):f();return j};a.cancelEditName=function(a){var d=u.getRoot(b),e=b.data.key.name,f=d.curEditNode;d.curEditNode&&l.cancelCurEditNode(b,a?a:f[e])};a.copyNode=function(a,d,e,k){if(!d||a&&!a.isParent&&b.data.keep.leaf&&e===f.move.TYPE_INNER)return null;var j=q.clone(d);a||(a=null,e=f.move.TYPE_INNER);e==f.move.TYPE_INNER?(d=function(){l.addNodes(b,a,[j],k)},b.async.enable&&q.canAsync(b,a)?l.asyncNode(b,a,k,d):d()):(l.addNodes(b,a.parentNode,[j],k),l.moveNode(b,a,j,e,!1,k));return j};a.editName=
function(a){a&&a.tId&&a===u.getNodeCache(b,a.tId)&&(a.parentTId&&l.expandCollapseParentNode(b,a.getParentNode(),!0),l.editNode(b,a))};a.moveNode=function(a,d,e,m){function j(){l.moveNode(b,a,d,e,!1,m)}if(!d)return d;if(a&&!a.isParent&&b.data.keep.leaf&&e===f.move.TYPE_INNER||a&&(d.parentTId==a.tId&&e==f.move.TYPE_INNER||0<k("#"+d.tId).find("#"+a.tId).length))return null;a||(a=null);b.async.enable&&q.canAsync(b,a)?l.asyncNode(b,a,m,j):j();return d};a.removeNode=function(a,d){a&&(d=!!d,d&&!1==q.apply(b.callback.beforeRemove,
[b.treeId,a],!0)||(l.removeNode(b,a),d&&this.setting.treeObj.trigger(f.event.REMOVE,[b.treeId,a])))};a.removeChildNodes=function(a){if(!a)return null;var d=a[b.data.key.children];l.removeChildNodes(b,a);return d?d:null};a.setEditable=function(a){b.edit.enable=a;return this.refresh()}});var m=l.cancelPreSelectedNode;l.cancelPreSelectedNode=function(b,a){for(var c=u.getRoot(b).curSelectedList,d=0,e=c.length;d<e;d++)if(!a||a===c[d])if(l.removeTreeDom(b,c[d]),a)break;m&&m.apply(l,arguments)};var s=l.createNodes;
l.createNodes=function(b,a,c,d){s&&s.apply(l,arguments);c&&l.repairParentChkClassWithSelf&&l.repairParentChkClassWithSelf(b,d)};l.makeNodeUrl=function(b,a){return a.url&&!b.edit.enable?a.url:null};var v=l.selectNode;l.selectNode=function(b,a,c){var d=u.getRoot(b);if(u.isSelectedNode(b,a)&&d.curEditNode==a&&a.editNameFlag)return!1;v&&v.apply(l,arguments);l.addHoverDom(b,a);return!0};var G=q.uCanDo;q.uCanDo=function(b,a){var c=u.getRoot(b);return a&&(q.eqs(a.type,"mouseover")||q.eqs(a.type,"mouseout")||
q.eqs(a.type,"mousedown")||q.eqs(a.type,"mouseup"))?!0:!c.curEditNode&&(G?G.apply(l,arguments):!0)}})(J)}});
